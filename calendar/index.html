<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <title>Hello, world!</title>

    <style>
        .calendar-header th{
            border:1px solid gray!important;
        }

        .calendar-dates{
            padding-bottom:50px!important;
            text-align:right;
            border:1px solid gray!important;
            cursor: pointer;
            /* padding-top:20px!important; */
        }
        
        .calendar-dates:hover{
            background-color: #004eff!important;
            color:#ffffff!important;
        }

        .calendar-dates div{
            height:35px;
        }

        .disabled-dates{
            background-color:#dbd9d9!important;
            pointer-events:none;
            color:#969494!important;
        }

        #calendar-prev-month, #calendar-next-month{
            font-weight: bold;
        }

        .available-room-div{
            text-align: center;
            font-size: 20px!important;
            font-weight: bold;
        }
    </style>
  </head>
  <body>
    <div class="container-fluid">
        <!-- <h1>Hello, world!</h1> -->
        <div class="available-room-div">
            <span>Available Dates for Room M1</span>
        </div>
        <div class="calendar-arrow" style="text-align:center;font-size:25px">
            <span id="calendar-prev-month"><</span>
            <span id="calendar-selected-month-name"></span>
            <span id="calendar-next-month">></span>
        </div>
        <table class="table">
            <thead>
                <tr class="table-light calendar-header" style="text-align:center">
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th>Sat</th>
                    <th>Sun</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
                <tr>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                    <td class="calendar-dates">
                        <div></div>
                    </td>
                </tr>
            </tbody>
        </table>
        <form class="pb-1">
            <div class="row">
                <div class="col-md-6">
                    <label class="col-sm-label">Start Date</label>
                    <input type="text" readonly class="form-control" name="booking_start_date">
                </div>
                <div class="col-md-6">
                    <label class="col-sm-label">End Date</label>
                    <input type="text" readonly class="form-control" name="booking_end_date">
                </div>
            </div>
            <button type="submit" class="btn btn-primary pt-1">Book</button>
        </form>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
    -->
    <script>
        var booking_start_date = "";
        var booking_end_date = "";
        var month_list = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December"
        ];
        var today = new Date();
        var current_month = today.getMonth()+1;
        if(current_month < 10){
            current_month = "0"+current_month;
        }
        console.log(current_month);
        var current_year = today.getFullYear();

        showCalendar(current_month, current_year);

        document.getElementById('calendar-prev-month').onclick = function(){
            // console.log('aaa');
            // current_month = ;
            current_month = parseInt(current_month);
            if(current_month == 1){
                current_month = 12;
                current_year = current_year - 1;
            }else{
                current_month = current_month - 1;
                if(current_month < 10){
                    current_month = "0"+current_month;
                }
            }
            console.log(current_month);
            showCalendar(current_month, current_year);
        }

        // document.querySelector('.calendar-dates').onclick = function(){
        //     console.log('blablabla');
        // };
        // var calendar_dates = document.getElementsByClassName('calendar-dates').length;

        // for(var g = 0; g < calendar_dates; g++){
        //     document.getElementsByClassName('calendar-dates')[g].onclick = function(){
        //         // console.log('bbb');
        //         booking_start_date = this.getAttribute('data-dates');
        //         document.getElementsByName('booking_start_date')[0].value = booking_start_date;
        //         console.log(booking_start_date);
        //     }
        // }

        document.getElementById('calendar-next-month').onclick = function(){
            // console.log('aaa');
            // current_month = ;
            current_month = parseInt(current_month);
            if(current_month == 12){
                current_month = 1;
                current_year = current_year + 1;
            }else{
                current_month = current_month + 1;
                if(current_month < 10){
                    current_month = "0"+current_month;
                }
            }
            console.log(current_month);
            showCalendar(current_month, current_year);
        }

        function showCalendar(selected_month, selected_year){
            // var today = new Date();
            // var current_month = today.getMonth()+1;
            // if(current_month < 10){
            //     current_month = "0"+current_month;
            // }
            // console.log(current_month);
            // var current_year = today.getFullYear();
            var first_day_of_selected_month = new Date(selected_year+"-"+selected_month+"-"+"01 00:00:00");
            console.log(selected_year+"-"+selected_month+"-"+"01 00:00:00");
            first_day_of_selected_month = first_day_of_selected_month.getDay();
            var total_days = function(month,year) {
                return new Date(year, month, 0).getDate();
            };
            console.log("first day in index: "+first_day_of_selected_month);
            var prev_month = parseInt(selected_month) - 1;
            var prev_year = selected_year;
            if(prev_month < 1){
                prev_month = 12;
                prev_year = prev_year - 1;
            }
            // if(prev_month)
            total_previous_days = total_days(prev_month,prev_year);
            total_days = total_days(selected_month,selected_year);
            console.log(total_days);
            console.log(total_previous_days);
            // console.log();
            total_rows = document.getElementsByClassName('calendar-dates').length;

            var days_index = 1;
            for(var k = 0; k < total_rows; k++){
                document.getElementsByClassName('calendar-dates')[k].innerHTML = "<div></div>";
                document.getElementsByClassName('calendar-dates')[k].classList.remove('disabled-dates');
            }
            if(first_day_of_selected_month == 0){
                first_day_of_selected_month = 7;
            }
            for(var k = 0; k < total_rows; k++){
                if(k >= (first_day_of_selected_month - 1)){
                    document.getElementsByClassName('calendar-dates')[k].innerHTML = "<div>"+(days_index)+"</div>";
                    document.getElementsByClassName('calendar-dates')[k].setAttribute('data-dates',(selected_year+'-'+selected_month+'-'+(days_index < 10 ? "0"+(days_index) : (days_index))));
                    days_index += 1;

                    document.getElementsByClassName('calendar-dates')[k].onclick = function(){
                        // console.log("aaaa");
                        booking_start_date = this.getAttribute('data-dates');
                        document.getElementsByName('booking_start_date')[0].value = booking_start_date;
                        var full_end_date = new Date(month_list[parseInt(selected_month) - 1]+' '+(parseInt(this.getAttribute('data-dates').split('-')[2]) < 10 ? ("0"+(parseInt(this.getAttribute('data-dates').split('-')[2]))) : parseInt(this.getAttribute('data-dates').split('-')[2]))+', '+selected_year);
                        // console.log();
                        full_end_date.setMonth(full_end_date.getMonth() + 1);
                        booking_end_date = full_end_date.toLocaleDateString();
                        booking_end_date = booking_end_date.split('/');
                        booking_end_date = booking_end_date[2]+'-'+(booking_end_date[0] < 10 ? ("0" + booking_end_date[0]) : booking_end_date[0])+'-'+(booking_end_date[1] < 10 ? ("0" + booking_end_date[1]) : booking_end_date[1]);
                        document.getElementsByName('booking_end_date')[0].value = booking_end_date;
                        console.log(booking_start_date);
                        console.log(booking_end_date);
                    }
                }
                if(k < (first_day_of_selected_month - 1)){
                    document.getElementsByClassName('calendar-dates')[k].classList.add('disabled-dates');
                    document.getElementsByClassName('calendar-dates')[k].setAttribute('data-dates',(prev_year+'-'+prev_month+'-'+(total_previous_days - (first_day_of_selected_month - 1) + k + 1)));
                    document.getElementsByClassName('calendar-dates')[k].innerHTML = (total_previous_days - (first_day_of_selected_month - 1) + k + 1);
                }
                if(days_index >= (total_days + 2)){
                    // break;
                    document.getElementsByClassName('calendar-dates')[k].classList.add('disabled-dates');
                    document.getElementsByClassName('calendar-dates')[k].innerHTML = "<div></div>";
                }
                // if(days_index == (total_days + 1)){
                //     break;
                // }
                // document.getElementsByClassName('calendar-dates')[k].innerHTML = "<div></div>";
            }
            document.getElementById('calendar-selected-month-name').innerHTML = month_list[selected_month - 1]+' '+selected_year;
            console.log("booking start date: "+booking_start_date);
        }
    </script>
  </body>
</html>